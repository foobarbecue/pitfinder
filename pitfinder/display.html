<!DOCTYPE html>

<html>

<head>
    <title>fitpit </title>
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/three.js/100/three.js"></script>
    <script type="text/javascript" src="./PLYLoader.js"></script>
    <script type="text/javascript" src="./OrbitControls.js"></script>

    <style>
        body {
            /* set margin to 0 and overflow to hidden, to go fullscreen */
            margin: 0;
            overflow: hidden;
        }
    </style>
</head>
<body>

<div id="Stats-output">
</div>
<!-- Div which will hold the Output -->
<div id="WebGL-output">
</div>

<!-- Javascript code that runs our Three.js examples -->
<script type="text/javascript">

	// once everything is loaded, we run our Three.js stuff.
	function init() {


			// create a scene, that will hold all our elements such as objects, cameras and lights.
			var scene = new THREE.Scene();
			window.scene = scene;

			// create a camera, which defines where we're looking at.
			var camera = new THREE.PerspectiveCamera(45, window.innerWidth / window.innerHeight, 0.1, 1000);

			var controls = new THREE.OrbitControls( camera );

			// create a render and set the size
			var webGLRenderer = new THREE.WebGLRenderer();
			webGLRenderer.setSize(window.innerWidth, window.innerHeight);
			webGLRenderer.shadowMapEnabled = true;

			// position and point the camera to the center of the scene
			camera.position.x = 10;
			camera.position.y = 10;
			camera.position.z = 10;
			camera.lookAt(new THREE.Vector3(0, -2, 0));

			// add spotlight for the shadows
			var ambLight = new THREE.HemisphereLight(0xffffff,0xff0000,1);
			ambLight.position.set(20,20,20);
			scene.add(ambLight);

			// add the output of the renderer to the html element
			document.getElementById("WebGL-output").appendChild(webGLRenderer.domElement);


			var loader = new THREE.PLYLoader();
			var meteorite = new THREE.Object3D();
			loader.load("../meshes/canyon_diablo_quads.ply", function (geometry) {
				var material = new THREE.MeshStandardMaterial({
                  color: 0xffffff,
				});

				meteorite = new THREE.Mesh(geometry, material);
                meteorite.name = 'meteorite';
				scene.add(meteorite);
			});


			render();

			var sphere_geom = new THREE.SphereGeometry(1,12, 12);
			var sphere = new THREE.Mesh(sphere_geom, new THREE.MeshStandardMaterial({
              color:'red',
              wireframe: true
            }));
            var rotation = new THREE.Matrix4();
            rotation.set(   -0.38306904,-0.30257626,0.87275754,    0,
						 0.13307275,0.91689682,0.37628694,    0,
						 -0.91408411,0.26028412,-0.31097013,    0,
							0, 0, 0);
			sphere.applyMatrix(rotation);
			sphere.position.set(0.65582235, 1.36944963, 0.61187177);
			sphere.scale.set(0.35436503, 0.44333685, 0.64841519);
			scene.add(sphere);


			function render() {

				if (meteorite) {

					// render using requestAnimationFrame
					requestAnimationFrame(render);
					controls.update();
					webGLRenderer.render(scene, camera);
				}
			}
		}

        window.onload = init;
</script>
</body>
</html>